rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /games/{game} {
      allow read: if true;
      allow write:if request.auth!=null&&request.resource.data.stars[request.auth.uid].uid==request.auth.uid
      &&canIncrement();
    }
    function canIncrement(){
    	// return true;
      return debug(request.resource.data.review_count)==debug(request.data.review_count);
      // ||!!get(/databases/$(database)/documents/games/$(request.resource.id)).stars[request.auth.uid]
    }
  }
}